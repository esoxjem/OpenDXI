<%# Developer Detail View %>
<div class="space-y-6">
  <%# Back link %>
  <div>
    <%= link_to "← Back to Dashboard",
          dashboard_path(sprint: @sprint.date_range_param, view: "developers"),
          class: "text-blue-600 hover:text-blue-800 text-sm" %>
  </div>

  <%# Developer Header %>
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex items-center space-x-4">
      <img class="h-16 w-16 rounded-full"
           src="https://github.com/<%= @developer['developer'] %>.png?size=128"
           alt="<%= @developer['developer'] %>">
      <div>
        <h2 class="text-2xl font-bold text-gray-900"><%= @developer['developer'] %></h2>
        <p class="text-gray-500">Sprint: <%= @sprint.label %></p>
      </div>
      <div class="ml-auto">
        <div class="text-center">
          <div class="text-3xl font-bold <%= dxi_score_class(@developer['dxi_score']) %>">
            <%= @developer['dxi_score']&.round(1) || "—" %>
          </div>
          <div class="text-sm text-gray-500">DXI Score</div>
        </div>
      </div>
    </div>
  </div>

  <%# Stats Grid %>
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
    <%= render "dashboard/kpi_card", title: "Commits", value: @developer['commits'] %>
    <%= render "dashboard/kpi_card", title: "PRs Opened", value: @developer['prs_opened'], subtitle: "#{@developer['prs_merged']} merged" %>
    <%= render "dashboard/kpi_card", title: "Reviews Given", value: @developer['reviews_given'] %>
    <%= render "dashboard/kpi_card", title: "Avg Cycle Time", value: format_hours(@developer['avg_cycle_time_hours']) %>
  </div>

  <%# Dimension Scores %>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <%# Bar breakdown %>
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Dimension Scores</h3>
      <div class="space-y-4">
        <% (@developer['dimension_scores'] || {}).each do |dim, score| %>
          <div class="flex items-center">
            <span class="w-40 text-sm text-gray-600"><%= dimension_label(dim) %></span>
            <div class="flex-1 h-4 bg-gray-200 rounded-full overflow-hidden">
              <div class="h-full <%= dimension_color_class(score) %> rounded-full transition-all duration-300"
                   style="width: <%= dimension_bar_width(score) %>%"></div>
            </div>
            <span class="w-16 text-right text-sm font-medium <%= dxi_score_class(score) %>">
              <%= score&.round(1) || "—" %>
            </span>
          </div>
        <% end %>
      </div>
    </div>

    <%# Radar Chart comparing to team %>
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">vs Team Average</h3>
      <%= render "dashboard/radar_chart",
            team_scores: @sprint.team_dimension_scores,
            developer_scores: @developer['dimension_scores'] %>
    </div>
  </div>

  <%# Lines Changed %>
  <div class="bg-white rounded-lg shadow p-6">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Code Changes</h3>
    <div class="flex items-center space-x-8">
      <div>
        <span class="text-2xl font-bold text-green-600">+<%= format_number(@developer['lines_added']) %></span>
        <span class="text-sm text-gray-500 ml-1">lines added</span>
      </div>
      <div>
        <span class="text-2xl font-bold text-red-600">-<%= format_number(@developer['lines_deleted']) %></span>
        <span class="text-sm text-gray-500 ml-1">lines deleted</span>
      </div>
      <% if @developer['prs_opened'].to_i > 0 %>
        <div class="text-gray-500">
          Avg PR size: <%= ((@developer['lines_added'].to_i + @developer['lines_deleted'].to_i) / @developer['prs_opened'].to_f).round(0) %> lines
        </div>
      <% end %>
    </div>
  </div>
</div>
